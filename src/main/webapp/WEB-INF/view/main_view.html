<!DOCTYPE html>
<html lang="zh-cn">
<head>
    <meta charset="utf-8">
    <title>实时监控控制台</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- 最新版本的 Bootstrap 核心 CSS 文件 -->
    <link href="/cctv/css/bootstrap.min.css" rel="stylesheet">
    <link href="/cctv/js/video-js-5.19.2/video-js.css" rel="stylesheet">
    <script src="/cctv/js/jquery.js"></script>
    <script src="/cctv/js/bootstrap.min.js" crossorigin="anonymous"></script>
    <script src="/cctv/js/video-js-5.19.2/video.js"></script>
    <style>

        .player-1-dimensions {
            width: 100%;
            min-height: 200px;
        }

        .player-2-dimensions {
            width: 100%;
            min-height: 200px;
        }

        .player-3-dimensions {
            width: 100%;
            min-height: 200px;
        }

        .player-4-dimensions {
            width: 100%;
            min-height: 200px;
        }

        .player-5-dimensions {
            width: 100%;
            min-height: 200px;
        }

        .player-6-dimensions {
            width: 100%;
            min-height: 200px;
        }

        .player-7-dimensions {
            width: 100%;
            min-height: 200px;
        }

        .player-8-dimensions {
            width: 100%;
            min-height: 200px;
        }

        .panel-container {
            padding-right: 5px;
            padding-left: 5px;
        }

        .panel-body {
            padding: 2px;
        }
    </style>
</head>
<body>
<div class="container">
    <div class="row">
        <div class="col-xs-12 col-sm-6 col-md-3 panel-container">
            <div class="panel panel-info">
                <div class="panel-heading">
                    <h5 id="l1" class="panel-title">线路1</h5>
                </div>
                <div class="panel-body">
                    <video id="player-1" class="video-js vjs-default-skin vjs-big-play-centered" controls preload="none"
                           width="100%"
                           poster="/cctv/images/y.jpg"
                           data-setup="{}">
                        <source src="rtmp://127.0.0.1/live/stream1" type="rtmp/flv"/>
                        <!--<source src="oceans-clip.mp4" type='video/mp4' />-->
                    </video>
                </div>
            </div>
        </div>
        <div class="col-xs-12 col-sm-6 col-md-3 panel-container">
            <div class="panel panel-info">
                <div class="panel-heading">
                    <h5 id="l2" class="panel-title">线路2</h5>
                </div>
                <div class="panel-body">
                    <video id="player-2" class="video-js vjs-default-skin vjs-big-play-centered" controls preload="none"
                           width="100%"
                           poster="/cctv/images/y.jpg"
                           data-setup="{}">
                        <source src="rtmp://127.0.0.1/live/stream2" type="rtmp/flv"/>
                        <!--<source src="oceans-clip.mp4" type='video/mp4' />-->
                    </video>
                </div>
            </div>
        </div>
        <div class="col-xs-12 col-sm-6 col-md-3 panel-container">
            <div class="panel panel-info">
                <div class="panel-heading">
                    <h5 id="l3" class="panel-title">线路3</h5>
                </div>
                <div class="panel-body">
                    <video id="player-3" class="video-js vjs-default-skin vjs-big-play-centered" controls preload="none"
                           width="100%"
                           poster="/cctv/images/y.jpg"
                           data-setup="{}">
                        <source src="rtmp://127.0.0.1/live/stream3" type="rtmp/flv"/>
                        <!--<source src="oceans-clip.mp4" type='video/mp4' />-->
                    </video>
                </div>
            </div>
        </div>
        <div class="col-xs-12 col-sm-6 col-md-3 panel-container">
            <div class="panel panel-info">
                <div class="panel-heading">
                    <h5 id="l4" class="panel-title">线路4</h5>
                </div>
                <div class="panel-body">
                    <video id="player-4" class="video-js vjs-default-skin vjs-big-play-centered" controls preload="none"
                           width="100%"
                           poster="/cctv/images/y.jpg"
                           data-setup="{}">
                        <source src="rtmp://127.0.0.1/live/stream4" type="rtmp/flv"/>
                        <!--<source src="oceans-clip.mp4" type='video/mp4' />-->
                    </video>
                </div>
            </div>
        </div>
    </div>
    <div class="row">
        <div class="col-xs-12 col-sm-6 col-md-3 panel-container">
            <div class="panel panel-info">
                <div class="panel-heading">
                    <h5 id="l5" class="panel-title">线路5</h5>
                </div>
                <div class="panel-body">
                    <video id="player-5" class="video-js vjs-default-skin vjs-big-play-centered" controls preload="none"
                           width="100%"
                           poster="/cctv/images/y.jpg"
                           data-setup="{}">
                        <source src="rtmp://127.0.0.1/live/stream5" type="rtmp/flv"/>
                        <!--<source src="oceans-clip.mp4" type='video/mp4' />-->
                    </video>
                </div>
            </div>
        </div>
        <div class="col-xs-12 col-sm-6 col-md-3 panel-container">
            <div class="panel panel-info">
                <div class="panel-heading">
                    <h5 id="l6" class="panel-title">线路6</h5>
                </div>
                <div class="panel-body">
                    <video id="player-6" class="video-js vjs-default-skin vjs-big-play-centered" controls preload="none"
                           width="100%"
                           poster="/cctv/images/y.jpg"
                           data-setup="{}">
                        <source src="rtmp://127.0.0.1/live/stream6" type="rtmp/flv"/>
                        <!--<source src="oceans-clip.mp4" type='video/mp4' />-->
                    </video>
                </div>
            </div>
        </div>
        <div class="col-xs-12 col-sm-6 col-md-3 panel-container">
            <div class="panel panel-info">
                <div class="panel-heading">
                    <h5 id="l7" class="panel-title">线路7</h5>
                </div>
                <div class="panel-body">
                    <video id="player-7" class="video-js vjs-default-skin vjs-big-play-centered" controls preload="none"
                           width="100%"
                           poster="/cctv/images/y.jpg"
                           data-setup="{}">
                        <source src="rtmp://127.0.0.1/live/stream7" type="rtmp/flv"/>
                        <!--<source src="oceans-clip.mp4" type='video/mp4' />-->
                    </video>
                </div>
            </div>
        </div>
        <div class="col-xs-12 col-sm-6 col-md-3 panel-container">
            <div class="panel panel-info">
                <div class="panel-heading">
                    <h5 id="l8" class="panel-title">线路8</h5>
                </div>
                <div class="panel-body">
                    <video id="player-8" class="video-js vjs-default-skin vjs-big-play-centered" controls preload="none"
                           width="100%"
                           poster="/cctv/images/y.jpg"
                           data-setup="{}">
                        <source src="rtmp://127.0.0.1/live/stream8" type="rtmp/flv"/>
                        <!--<source src="oceans-clip.mp4" type='video/mp4' />-->
                    </video>
                </div>
            </div>
        </div>
    </div>
    <!--<div class="row">-->
    <!--<div class="col-xs-12 col-sm-6 col-md-3">-->
    <!--<h3 style="color: #ebcccc">设置线路</h3>-->
    <!--<table cellpadding="0" cellspacing="3" border="0">-->
    <!--<tr>-->
    <!--<input type="button" style="padding: 8px;border-color: lime" type="set" class="btn" value="设置" onclick="setLine();"/>-->
    <!--</tr>-->

    <!--<tr>-->
    <!--<td style="text-decoration:underline;" class="tt1">线路名:</td>-->
    <!--<td colspan="3"><input id="lineName" type="text" class="txt"/>-->
    <!--</td>-->
    <!--</tr>-->
    <!--<tr>-->
    <!--<td style="text-decoration:underline;" class="tt">rtsp路径:</td>-->
    <!--<td colspan="3"><input id="rtspPath" type="text" class="txt"/>-->
    <!--</td>-->
    <!--</tr>-->
    <!--<tr>-->
    <!--<td style="text-decoration:underline;" class="tt">rtmp路径:</td>-->
    <!--<td colspan="3"><input id="rtmpPath" type="text" class="txt"/>-->
    <!--</td>-->
    <!--</tr>-->

    <!--</table>-->
    <!--</div>-->
    <!--<div class="col-xs-12 col-sm-6 col-md-3">-->
    <!--<h3 style="color: #ebcccc">终止线路</h3>-->
    <!--<table cellpadding="0" cellspacing="3" border="0">-->
    <!--<tr>-->
    <!--<td style="text-decoration:underline;" class="tt1">线路名:</td>-->
    <!--<td colspan="3"><input id="stopLineName" type="text" class="txt" />-->
    <!--</td>-->
    <!--</tr>-->

    <!--<tr>-->
    <!--<input type="button" style="padding: 8px;border-color: lime" class="btn" value="终止" onclick="stopLine();"/>-->
    <!--</tr>-->
    <!--</table>-->
    <!--</div>-->
    <!--<div class="col-xs-12 col-sm-6 col-md-3">-->
    <!--<h3 style="color: #ebcccc">启动线路</h3>-->
    <!--<table cellpadding="0" cellspacing="3" border="0">-->
    <!--<tr>-->
    <!--<td style="text-decoration:underline;" class="tt1">线路名:</td>-->
    <!--<td colspan="3"><input id="startLineName" type="text" class="txt" />-->
    <!--</td>-->
    <!--</tr>-->
    <!--<tr>-->
    <!--<input type="button" style="padding: 8px;border-color: lime" class="btn" value="启动" onclick="startLine();"/>-->
    <!--</tr>-->
    <!--</table>-->
    <!--</div>-->
    <!--<div class="col-xs-12 col-sm-6 col-md-3">-->
    <!--<h3 style="color: #ebcccc;">所有线路</h3>-->
    <!--<table cellpadding="0" cellspacing="3" border="0">-->
    <!--<tr>-->

    <!--<td colspan="5">-->
    <!--<input type="button" style="padding: 8px;border-color: lime" class="btn" value="启动所有" onclick="startAllLine();"/>-->
    <!--</td>-->
    <!--</tr>-->
    <!--<tr>-->
    <!--<input type="button" style="padding: 8px;border-color: lime" class="btn" value="停止所有" onclick="stopAllLine();"/>-->
    <!--</tr>-->
    <!--</table>-->
    <!--</div>-->
    <!--</div>-->
</div>


<script type="text/javascript">
    var lineNames = ["线路1", "线路2", "线路3", "线路4", "线路5", "线路6", "线路7", "线路8"];
    $(function () {
        for (var j = 1, l = lineNames.length + 1; j < l; j++) {
            var id = "l" + j;
            document.getElementById(id).innerHTML = lineNames[j - 1];
        }
    });


    function stopLine() {
        var lineName = $("#stopLineName").val();
        var idx = indexOfArray(lineNames, lineName);
        if (idx < 0) {
            alert("Input name is not expected");
            return;
        }
        var formData = new FormData();
        formData.append("lineName", lineName);
        $.ajax({
            type: "POST",
            url: "/cctv/line/stop",
            contentType: false,    //不可缺
            processData: false,    //不可缺;
            dataType: "json",
            data: formData,
            // async: false,
            success: function (suc) {
                console.info(suc);
                alert(suc.msg);
                return false;
            },
            error: function (XMLHttpRequest, textStatus, errorThrown) {
                alert("error.ajax" + textStatus + errorThrown);
                return false;
            }
        });
    }

    function setLine() {
        var lineName = $("#lineName").val();
        var idx = indexOfArray(lineNames, lineName);
        if (idx < 0) {
            alert("Input name is not expected");
            return;
        }
        var videoId = "player-" + (idx + 1);
        video = videojs(document.getElementById(videoId), {}, function () {
        });
        video.pause();

        var formData = new FormData();
        formData.append("lineName", lineName);
        formData.append("rtmpPath", $("#rtmpPath").val());
        formData.append("rtspPath", $("#rtspPath").val());
        $.ajax({
            type: "POST",
            url: "/cctv/line/set",
            contentType: false,    //不可缺
            processData: false,    //不可缺;
            dataType: "json",
            data: formData,
            // async: false,
            success: function (suc) {
                console.info(suc);
                video.src(suc.data);
                alert(suc.msg);
                return false;
            },
            error: function (XMLHttpRequest, textStatus, errorThrown) {
                alert("error.ajax" + textStatus + errorThrown);
                return false;
            }
        });
    }

    function startLine() {
        var lineName = $("#startLineName").val();
        var idx = indexOfArray(lineNames, lineName);
        if (idx < -1) {
            alert("Input name is not expected");
            return;
        }
        var videoId = "player-" + (idx + 1);
        video = videojs(document.getElementById(videoId), {}, function () {
        });
        video.pause();
        var formData = new FormData();
        formData.append("lineName", lineName);
        $.ajax({
            type: "POST",
            url: "/cctv/line/start",
            contentType: false,    //不可缺
            processData: false,    //不可缺;
            dataType: "json",
            data: formData,
            // async: false,
            success: function (suc) {
                console.info(suc);
                video.src(suc.data);
                video.play();
                alert(suc.msg);

                return false;
            },
            error: function (XMLHttpRequest, textStatus, errorThrown) {
                alert("error.ajax" + textStatus + errorThrown);
                return false;
            }
        });
    }

    function startAllLine() {
        $.ajax({
            type: "POST",
            url: "/cctv/line/startAll",
            contentType: false,    //不可缺
            processData: false,    //不可缺;
            dataType: "json",
            // async: false,
            success: function (suc) {
                console.info(suc);
                alert(suc.msg);
                return false;

            },
            error: function (XMLHttpRequest, textStatus, errorThrown) {
                alert("error.ajax" + textStatus + errorThrown);
                return false;
            }
        });
    }

    function stopAllLine() {
        $.ajax({
            type: "POST",
            url: "/cctv/line/stopAll",
            contentType: false,    //不可缺
            processData: false,    //不可缺;
            dataType: "json",
            // async: false,
            success: function (suc) {
                console.info(suc);
                alert(suc.msg);
                return false;
            },
            error: function (XMLHttpRequest, textStatus, errorThrown) {
                alert("error.ajax" + textStatus + errorThrown);
                return false;
            }
        });
    }


    function indexOfArray(arr, item) {

        if (Array.prototype.indexOf) {
            return arr.indexOf(item);
        }
        else {
            for (var i = 0; i < arr.length; i++) {
                if (arr[i] === item) {
                    return i;
                }
            }
        }
        return -1;

    }
</script>
</body>
</html>